<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Formatting · Highlights.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Ubuntu+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../../versions.js"></script></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="Highlights.jl logo"/></a><h1>Highlights.jl</h1><form class="search" action="../search.html"><select id="version-selector" onChange="window.location.href=this.value"><option value="#" selected="selected" disabled="disabled">Version</option></select><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="guide.html">User Guide</a></li><li><a class="toctext" href="theme.html">Theme Guide</a></li><li><a class="toctext" href="lexer.html">Lexer Guide</a></li><li class="current"><a class="toctext" href="formatting.html">Formatting</a><ul class="internal"></ul></li></ul></li><li><span class="toctext">Demos</span><ul><li><a class="toctext" href="../demo/lexers.html">Lexers</a></li><li><a class="toctext" href="../demo/themes.html">Themes</a></li></ul></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="../lib/public.html">Public Interface</a></li><li><a class="toctext" href="../lib/internals.html">Package Internals</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href="formatting.html">Formatting</a></li></ul><a class="edit-page" href="https://github.com/JuliaDocs/Highlights.jl/tree/0830856e1fc5e26431990ead4d248d643a627459/docs/src/man/formatting.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Formatting-1" href="#Formatting-1">Formatting</a></h1><p><code>Highlights</code> provides two output formats for highlighted source code, namely <code>text/html</code> and <code>text/latex</code> – both of which have been shown in previous sections of this manual. In this section we&#39;ll be describing how to go about extending <code>Highlights</code> formatting to support user-defined formats.</p><p>To begin we will need to import the <code>Format</code> module from <code>Highlights</code>.</p><pre><code class="language-julia">using Highlights.Format</code></pre><p>Now we need to decide on a format the we&#39;d like to add. We&#39;ll be adding an ANSI formatter that can be used to display highlighted source code in the terminal. For that we&#39;ll need to install the <code>Crayons</code> package.</p><pre><code class="language-julia">Pkg.add(&quot;Crayons&quot;)
using Crayons</code></pre><p>Next we&#39;ll define a <code>Format.render</code> method that will be used to highlight tokenised source code using a user-provided theme.</p><pre><code class="language-julia">function Format.render(io::IO, ::MIME&quot;text/ansi&quot;, tokens::Format.TokenIterator)
    for (str, id, style) in tokens
        fg = style.fg.active ? map(Int, (style.fg.r, style.fg.g, style.fg.b)) : :nothing
        bg = style.bg.active ? map(Int, (style.bg.r, style.bg.g, style.bg.b)) : :nothing
        crayon = Crayon(
            foreground = fg,
            background = bg,
            bold       = style.bold,
            italics    = style.italic,
            underline  = style.underline,
        )
        print(io, crayon, str, inv(crayon))
    end
end</code></pre><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The <code>io</code> argument to <code>render</code> needs to be a subtype of <code>IO</code>. To allow for more exotic &quot;buffer&quot;-like objects, such as <code>push!</code>ing rendered tokens to a vector one can use a custom wrapper type such as</p><pre><code class="language-julia">immutable BufferWrapper &lt;: IO
    buffer::IOBuffer
    data::Vector{RGBA{Float32}}
end</code></pre><p>where the source needs to be written to a buffer while the colour data has to be pushed to a separate vector of colours.</p></div></div><p>To view highlighted source code in the terminal we can then just call</p><pre><code class="language-none">julia&gt; highlight(STDOUT, MIME(&quot;text/ansi&quot;), source, Lexers.JuliaLexer)</code></pre><footer><hr/><a class="previous" href="lexer.html"><span class="direction">Previous</span><span class="title">Lexer Guide</span></a><a class="next" href="../demo/lexers.html"><span class="direction">Next</span><span class="title">Lexers</span></a></footer></article></body></html>
